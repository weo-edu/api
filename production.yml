#
# Production Stack
#

#
# WEO Frontend Load Balancer
#
weo-lb:
  image: 'tutum/haproxy:0.1'
  autorestart: 'always'
  tags:
    - production
  links:
    - weo
  ports:
    - '80:80'
    - '443:443'
  roles:
    - global
  environment:
    BACKEND_PORT: 3000
    # SSL Certificate String is the concatenation of
    # the private key and the public certificate, with
    # newlines replaced with '\n'.
    #
    # It can be produced with this command:
    # cat www_weo_io.crt DigiCertCA.crt TrustedRoot.crt weo.pem
    SSL_CERT: -----BEGIN CERTIFICATE-----\nMIIH+jCCBuKgAwIBAgIQBMGLtOW9aFbXrogz4j0QYjANBgkqhkiG9w0BAQsFADB1\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMTQwMgYDVQQDEytEaWdpQ2VydCBTSEEyIEV4dGVuZGVk\nIFZhbGlkYXRpb24gU2VydmVyIENBMB4XDTE3MDQyNDAwMDAwMFoXDTE4MDUwMTEy\nMDAwMFowggECMR0wGwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjETMBEGCysG\nAQQBgjc8AgEDEwJVUzEbMBkGCysGAQQBgjc8AgECEwpDYWxpZm9ybmlhMREwDwYD\nVQQFEwhDMzQ4NTc5MzEcMBoGA1UECRMTOTMxIE4uIEhpZ2hsYW5kIEF2ZTEOMAwG\nA1UEERMFOTAwMzgxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRQw\nEgYDVQQHEwtMb3MgQW5nZWxlczEhMB8GA1UEChMYV0VPIEVkdWNhdGlvbmFsIFNv\nZnR3YXJlMRMwEQYDVQQDEwp3d3cud2VvLmlvMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEA6gl3/OlMWiHH42PZdAjaLvTSZXlfwxH9asDLRjINveQBOF+x\n24sqjwwqYKbtHhydV6SqdcbK2vpvnJTCPpmf2HTJkJAvDv3BiGzTqryT7Vjp65lG\nOJWJMVjbiTaMOS0pdJNMznVo07gTws8qkdaCHUxBmxF87CMCQxdqGJH4f4gkh3Fd\nH1csIEVpcD6rNLDSA2zkbn06TpaRfqMncXaFP+H0Whhe2Bx0sE1GhsBp2GkIOq+r\nUsFaksCXYo6eKyi+MZeqR4+ah4P+ABwqcHbopaFETFpibAVuRrYwpIcxm97hwyDL\nSsrRRDk8JxwfH4ncRtfET8tekthU5h+sl+kOZQIDAQABo4ID9TCCA/EwHwYDVR0j\nBBgwFoAUPdNQpdagre7zSmAKZdMh1Pj41g8wHQYDVR0OBBYEFJk8y6nWd1yiiC5d\ndxDOegy4od5MMCkGA1UdEQQiMCCCCnd3dy53ZW8uaW+CCmFwaS53ZW8uaW+CBndl\nby5pbzAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUF\nBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9z\naGEyLWV2LXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0\nLmNvbS9zaGEyLWV2LXNlcnZlci1nMS5jcmwwSwYDVR0gBEQwQjA3BglghkgBhv1s\nAgEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAH\nBgVngQwBATCBiAYIKwYBBQUHAQEEfDB6MCQGCCsGAQUFBzABhhhodHRwOi8vb2Nz\ncC5kaWdpY2VydC5jb20wUgYIKwYBBQUHMAKGRmh0dHA6Ly9jYWNlcnRzLmRpZ2lj\nZXJ0LmNvbS9EaWdpQ2VydFNIQTJFeHRlbmRlZFZhbGlkYXRpb25TZXJ2ZXJDQS5j\ncnQwDAYDVR0TAQH/BAIwADCCAfYGCisGAQQB1nkCBAIEggHmBIIB4gHgAHcApLkJ\nkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFbojb4eAAABAMASDBGAiEA\n8zBCLv/eG2vYwiAQvENSemqhz0xkMbRYDO9ROhJv68YCIQDOj0DWKGxG3yUpYUh5\n3YzzyNHSMf/Ps3Vyf/To8wGdmQB1AFYUBpov18Ls0/XhvUSyPsdGdrm8mRFcwO+U\nmFXWidDdAAABW6I2+JUAAAQDAEYwRAIgLVG9FX+MBUz0sqFAKrh3wYMeerVP3LRi\n42irMcw3yEkCIEu3FatuoiExQW2WmDk2wPhTL16TCYEDDvKYP1Fs4DUIAHcA7ku9\nt3XOYLrhQmkfq+GeZqMPfl+wctiDAMR7iXqo/csAAAFbojb3zgAABAMASDBGAiEA\nnL7cQ9gmcDbEF2u0/Z6I2IOotAO5OeG6LFLGsouKcG0CIQD1BfMJn3CHIFmix7ib\nAxCpz4o/4XxYpsEhhb/zG2gIEwB1ALvZ37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCW\nZDaOHtGFAAABW6I2+HQAAAQDAEYwRAIgYodEzjbhPQ9kaEnAgrJsE4xmowYuEFg4\nRMqU+g7yhvUCICq5PXPmYa2/zzUgs2sMd0HwHWTo/nHtR7rA1W8Z6/DfMA0GCSqG\nSIb3DQEBCwUAA4IBAQCVfeq2/jFbNqeiqXCUNgJHr8CjraU9VpQzElaJp0XJlXfd\nwjUEPOA2c2VVKPZXabHMjHVLYfhzc1lNVp9FBIir7iH8xd+Z+tb4cxSXCPIeL0Ci\n/8R8uuKTiOj3xwtrCUEpr9ytyhJ/kdr78C8CQRRoYUYmWG1U3Pv2u1Ubh/BKTKfI\nOin4nrc8aYexcwy1ltfWPWwq87IoBiR28pZ2IfB/S6pDKLA256XWfVTyZ/xjVcxm\nvgVAyPvUC9UVM1AphxduM6x/s1/EMfaxbtDWS8jJqW5uDQMFYsO+TBrzixbEZf/I\nsHGEpSK+GdS5s8RmSCt07m1BZgPJ8LVubVCuu9xV\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEtjCCA56gAwIBAgIQDHmpRLCMEZUgkmFf4msdgzANBgkqhkiG9w0BAQsFADBs\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j\nZSBFViBSb290IENBMB4XDTEzMTAyMjEyMDAwMFoXDTI4MTAyMjEyMDAwMFowdTEL\nMAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3\nLmRpZ2ljZXJ0LmNvbTE0MDIGA1UEAxMrRGlnaUNlcnQgU0hBMiBFeHRlbmRlZCBW\nYWxpZGF0aW9uIFNlcnZlciBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC\nggEBANdTpARR+JmmFkhLZyeqk0nQOe0MsLAAh/FnKIaFjI5j2ryxQDji0/XspQUY\nuD0+xZkXMuwYjPrxDKZkIYXLBxA0sFKIKx9om9KxjxKws9LniB8f7zh3VFNfgHk/\nLhqqqB5LKw2rt2O5Nbd9FLxZS99RStKh4gzikIKHaq7q12TWmFXo/a8aUGxUvBHy\n/Urynbt/DvTVvo4WiRJV2MBxNO723C3sxIclho3YIeSwTQyJ3DkmF93215SF2AQh\ncJ1vb/9cuhnhRctWVyh+HA1BV6q3uCe7seT6Ku8hI3UarS2bhjWMnHe1c63YlC3k\n8wyd7sFOYn4XwHGeLN7x+RAoGTMCAwEAAaOCAUkwggFFMBIGA1UdEwEB/wQIMAYB\nAf8CAQAwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEF\nBQcDAjA0BggrBgEFBQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRp\nZ2ljZXJ0LmNvbTBLBgNVHR8ERDBCMECgPqA8hjpodHRwOi8vY3JsNC5kaWdpY2Vy\ndC5jb20vRGlnaUNlcnRIaWdoQXNzdXJhbmNlRVZSb290Q0EuY3JsMD0GA1UdIAQ2\nMDQwMgYEVR0gADAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5j\nb20vQ1BTMB0GA1UdDgQWBBQ901Cl1qCt7vNKYApl0yHU+PjWDzAfBgNVHSMEGDAW\ngBSxPsNpA/i/RwHUmCYaCALvY2QrwzANBgkqhkiG9w0BAQsFAAOCAQEAnbbQkIbh\nhgLtxaDwNBx0wY12zIYKqPBKikLWP8ipTa18CK3mtlC4ohpNiAexKSHc59rGPCHg\n4xFJcKx6HQGkyhE6V6t9VypAdP3THYUYUN9XR3WhfVUgLkc3UHKMf4Ib0mKPLQNa\n2sPIoc4sUqIAY+tzunHISScjl2SFnjgOrWNoPLpSgVh5oywM395t6zHyuqB8bPEs\n1OG9d4Q3A84ytciagRpKkk47RpqF/oOi+Z6Mo8wNXrM9zwR4jxQUezKcxwCmXMS1\noVWNWlZopCJwqjyBcdmdqEU79OX2olHdx3ti6G8MdOu42vi/hw15UJGQmxg7kVkn\n8TUoE6smftX3eg==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIDxTCCAq2gAwIBAgIQAqxcJmoLQJuPC3nyrkYldzANBgkqhkiG9w0BAQUFADBs\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j\nZSBFViBSb290IENBMB4XDTA2MTExMDAwMDAwMFoXDTMxMTExMDAwMDAwMFowbDEL\nMAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3\nLmRpZ2ljZXJ0LmNvbTErMCkGA1UEAxMiRGlnaUNlcnQgSGlnaCBBc3N1cmFuY2Ug\nRVYgUm9vdCBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMbM5XPm\n+9S75S0tMqbf5YE/yc0lSbZxKsPVlDRnogocsF9ppkCxxLeyj9CYpKlBWTrT3JTW\nPNt0OKRKzE0lgvdKpVMSOO7zSW1xkX5jtqumX8OkhPhPYlG++MXs2ziS4wblCJEM\nxChBVfvLWokVfnHoNb9Ncgk9vjo4UFt3MRuNs8ckRZqnrG0AFFoEt7oT61EKmEFB\nIk5lYYeBQVCmeVyJ3hlKV9Uu5l0cUyx+mM0aBhakaHPQNAQTXKFx01p8VdteZOE3\nhzBWBOURtCmAEvF5OYiiAhF8J2a3iLd48soKqDirCmTCv2ZdlYTBoSUeh10aUAsg\nEsxBu24LUTi4S8sCAwEAAaNjMGEwDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQF\nMAMBAf8wHQYDVR0OBBYEFLE+w2kD+L9HAdSYJhoIAu9jZCvDMB8GA1UdIwQYMBaA\nFLE+w2kD+L9HAdSYJhoIAu9jZCvDMA0GCSqGSIb3DQEBBQUAA4IBAQAcGgaX3Nec\nnzyIZgYIVyHbIUf4KmeqvxgydkAQV8GK83rZEWWONfqe/EW1ntlMMUu4kehDLI6z\neM7b41N5cdblIZQB2lWHmiRk9opmzN6cN82oNLFpmyPInngiK3BD41VHMWEZ71jF\nhS9OMPagMRYjyOfiZRYzy78aG6A9+MpeizGLYAiJLQwGXFK3xPkKmNEVX58Svnw2\nYzi9RKR/5CYrCsSXaQ3pjOLAEFe4yHYSkVXySGnYvCoCWw9E1CAx2/S6cCZdkGCe\nvEsXCS+0yx5DaMkHJ8HSXPfqIbloEpw8nL+e/IBcm2PN7EeqJSdnoDfzAIJ9VNep\n+OkuE6N36B9K\n-----END CERTIFICATE-----\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA6gl3/OlMWiHH42PZdAjaLvTSZXlfwxH9asDLRjINveQBOF+x\n24sqjwwqYKbtHhydV6SqdcbK2vpvnJTCPpmf2HTJkJAvDv3BiGzTqryT7Vjp65lG\nOJWJMVjbiTaMOS0pdJNMznVo07gTws8qkdaCHUxBmxF87CMCQxdqGJH4f4gkh3Fd\nH1csIEVpcD6rNLDSA2zkbn06TpaRfqMncXaFP+H0Whhe2Bx0sE1GhsBp2GkIOq+r\nUsFaksCXYo6eKyi+MZeqR4+ah4P+ABwqcHbopaFETFpibAVuRrYwpIcxm97hwyDL\nSsrRRDk8JxwfH4ncRtfET8tekthU5h+sl+kOZQIDAQABAoIBADhWTyvyfQ61UwjJ\n4G6uMtda18rVjNfIXNh10Hj1U5mCaUjIwGe4+GW25/ycMjgtazLN0LrJP8u2vWdT\n5+5pzLCubFcAXlOdghj1GX7gJjvcS3MLUnwMgxn96dr95oNc+720N6j7WmCczyT1\n+alhmbCzypcpfojZZJIB8Og5Ozh3d2ZAkOe7GRLcP/NC29t8yms1x/lfGvJWkpCm\nA5IX2C0jQ+RQ+KwkRfoGEDx8JAdLLnQHJdy4o+zmzJ9Uo41abwGWGXfUGNhLZOjr\nz7k4hhaX0+IgdcvQJ2XV+8X42phOPhQ5y/d5yPgKfUHizOa6kYoETFVHg/DW9Gyo\n2FPju4ECgYEA/h9rzp11+1suhDfBC2hz5xZVqYjzOcj/QMHXt0LByimEi93n+hf8\nt0xkwkGv+vA0J6D9M1XMgnV+LgFjMExfYoY8xzWfaIykxgy5X8cFyV0N1S874Y9i\nkTtDqPe9JiBXanNE1TmmQ5zcnpSTwelXJW+3ap017q/Ip1W5DtcC6VsCgYEA68QQ\nFebxRlpLCVFevfE5tMrQ0T0uR+XkFnZLXqfFLkjO2hUI+ljWv363BQHgpu610pfJ\n71t84eP3OPzuG8sWROLVg9FUJMwRohJFUAhVnLOUTXWVjBYtt0zq+XXuYnEAF7ns\nDjE+gnW3JGG4ao7fPLzO+0tyPJpyQPpgTdbFsz8CgYEAlUMjcYKvb+pI0kRlUSwT\nF+LYgfH82y4iL4ksCWpepT3pqrW2sgEw4QEwFaG7metI1xYKYwK8UsxsRt1tw0q4\npAgw3tmyPhiOF/4VTBp8XaAYpeVOiNhNjvx+a1rIcQKCFfaKsatg60nRlBu1Birm\nkwihdS/OI9qAQzlorzy/aw0CgYAqtmV3olQ5u6f2czBn1ujucQPttFjLG8H7s8ip\nyFk3rmcTKVZsDGYzYSCFHrb1Zy+3jFpAK+HvBp7GS0RT8rIBHtsxu120IOhc5VR7\nUFc6QWpvsgq6y1XS7HNxaEUcvn4Wzk8Orys09WCNjcqcO3AED+yrqBp1EkH6taF2\n2J8OfwKBgQCV04QaRFkZ3tMUloujkw7GHlttGL0TmzYZihHZZqRzUArwrSvDkHvA\nHJkv0Ui/Y+/Ka9rffS1DgeCU/3e2Sgl60MfzNfBfQeSLRmSClfQkOrOBiZmE+P+N\nWNx5qjhYfth00757jNTQmLDJELZBtyJ18IDLV8AFnhnaCOVO6Ut/JQ==\n-----END RSA PRIVATE KEY-----\n

#
# WEO Frontend Server
#
weo:
  image: 'weoedu/weo:production'
  target_num_containers: 5
  autoredeploy: true
  autorestart: 'always'
  tags:
    - production
  expose:
    - '3000'
  environment:
    NODE_ENV: production
    PAPERTRAIL_HOST: logs2.papertrailapp.com
    PAPERTRAIL_PORT: 15920

#
# API Backend Load Balancer
#
api-lb:
  image: 'tutum/haproxy:0.1'
  autorestart: 'always'
  tags:
    - production
  links:
    - api
  ports:
    - '80:80'
    - '443:443'
  roles:
    - global
  environment:
    BACKEND_PORT: 3000
    SESSION_COOKIE: io  # use socket.io's io session cookie for
                        # session persistence

    # SSL Certificate String is the concatenation of
    # the private key and the public certificate, with
    # newlines replaced with '\n'.
    SSL_CERT: -----BEGIN CERTIFICATE-----\nMIIH+jCCBuKgAwIBAgIQBMGLtOW9aFbXrogz4j0QYjANBgkqhkiG9w0BAQsFADB1\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMTQwMgYDVQQDEytEaWdpQ2VydCBTSEEyIEV4dGVuZGVk\nIFZhbGlkYXRpb24gU2VydmVyIENBMB4XDTE3MDQyNDAwMDAwMFoXDTE4MDUwMTEy\nMDAwMFowggECMR0wGwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjETMBEGCysG\nAQQBgjc8AgEDEwJVUzEbMBkGCysGAQQBgjc8AgECEwpDYWxpZm9ybmlhMREwDwYD\nVQQFEwhDMzQ4NTc5MzEcMBoGA1UECRMTOTMxIE4uIEhpZ2hsYW5kIEF2ZTEOMAwG\nA1UEERMFOTAwMzgxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRQw\nEgYDVQQHEwtMb3MgQW5nZWxlczEhMB8GA1UEChMYV0VPIEVkdWNhdGlvbmFsIFNv\nZnR3YXJlMRMwEQYDVQQDEwp3d3cud2VvLmlvMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEA6gl3/OlMWiHH42PZdAjaLvTSZXlfwxH9asDLRjINveQBOF+x\n24sqjwwqYKbtHhydV6SqdcbK2vpvnJTCPpmf2HTJkJAvDv3BiGzTqryT7Vjp65lG\nOJWJMVjbiTaMOS0pdJNMznVo07gTws8qkdaCHUxBmxF87CMCQxdqGJH4f4gkh3Fd\nH1csIEVpcD6rNLDSA2zkbn06TpaRfqMncXaFP+H0Whhe2Bx0sE1GhsBp2GkIOq+r\nUsFaksCXYo6eKyi+MZeqR4+ah4P+ABwqcHbopaFETFpibAVuRrYwpIcxm97hwyDL\nSsrRRDk8JxwfH4ncRtfET8tekthU5h+sl+kOZQIDAQABo4ID9TCCA/EwHwYDVR0j\nBBgwFoAUPdNQpdagre7zSmAKZdMh1Pj41g8wHQYDVR0OBBYEFJk8y6nWd1yiiC5d\ndxDOegy4od5MMCkGA1UdEQQiMCCCCnd3dy53ZW8uaW+CCmFwaS53ZW8uaW+CBndl\nby5pbzAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUF\nBwMCMHUGA1UdHwRuMGwwNKAyoDCGLmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9z\naGEyLWV2LXNlcnZlci1nMS5jcmwwNKAyoDCGLmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0\nLmNvbS9zaGEyLWV2LXNlcnZlci1nMS5jcmwwSwYDVR0gBEQwQjA3BglghkgBhv1s\nAgEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAH\nBgVngQwBATCBiAYIKwYBBQUHAQEEfDB6MCQGCCsGAQUFBzABhhhodHRwOi8vb2Nz\ncC5kaWdpY2VydC5jb20wUgYIKwYBBQUHMAKGRmh0dHA6Ly9jYWNlcnRzLmRpZ2lj\nZXJ0LmNvbS9EaWdpQ2VydFNIQTJFeHRlbmRlZFZhbGlkYXRpb25TZXJ2ZXJDQS5j\ncnQwDAYDVR0TAQH/BAIwADCCAfYGCisGAQQB1nkCBAIEggHmBIIB4gHgAHcApLkJ\nkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFbojb4eAAABAMASDBGAiEA\n8zBCLv/eG2vYwiAQvENSemqhz0xkMbRYDO9ROhJv68YCIQDOj0DWKGxG3yUpYUh5\n3YzzyNHSMf/Ps3Vyf/To8wGdmQB1AFYUBpov18Ls0/XhvUSyPsdGdrm8mRFcwO+U\nmFXWidDdAAABW6I2+JUAAAQDAEYwRAIgLVG9FX+MBUz0sqFAKrh3wYMeerVP3LRi\n42irMcw3yEkCIEu3FatuoiExQW2WmDk2wPhTL16TCYEDDvKYP1Fs4DUIAHcA7ku9\nt3XOYLrhQmkfq+GeZqMPfl+wctiDAMR7iXqo/csAAAFbojb3zgAABAMASDBGAiEA\nnL7cQ9gmcDbEF2u0/Z6I2IOotAO5OeG6LFLGsouKcG0CIQD1BfMJn3CHIFmix7ib\nAxCpz4o/4XxYpsEhhb/zG2gIEwB1ALvZ37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCW\nZDaOHtGFAAABW6I2+HQAAAQDAEYwRAIgYodEzjbhPQ9kaEnAgrJsE4xmowYuEFg4\nRMqU+g7yhvUCICq5PXPmYa2/zzUgs2sMd0HwHWTo/nHtR7rA1W8Z6/DfMA0GCSqG\nSIb3DQEBCwUAA4IBAQCVfeq2/jFbNqeiqXCUNgJHr8CjraU9VpQzElaJp0XJlXfd\nwjUEPOA2c2VVKPZXabHMjHVLYfhzc1lNVp9FBIir7iH8xd+Z+tb4cxSXCPIeL0Ci\n/8R8uuKTiOj3xwtrCUEpr9ytyhJ/kdr78C8CQRRoYUYmWG1U3Pv2u1Ubh/BKTKfI\nOin4nrc8aYexcwy1ltfWPWwq87IoBiR28pZ2IfB/S6pDKLA256XWfVTyZ/xjVcxm\nvgVAyPvUC9UVM1AphxduM6x/s1/EMfaxbtDWS8jJqW5uDQMFYsO+TBrzixbEZf/I\nsHGEpSK+GdS5s8RmSCt07m1BZgPJ8LVubVCuu9xV\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEtjCCA56gAwIBAgIQDHmpRLCMEZUgkmFf4msdgzANBgkqhkiG9w0BAQsFADBs\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j\nZSBFViBSb290IENBMB4XDTEzMTAyMjEyMDAwMFoXDTI4MTAyMjEyMDAwMFowdTEL\nMAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3\nLmRpZ2ljZXJ0LmNvbTE0MDIGA1UEAxMrRGlnaUNlcnQgU0hBMiBFeHRlbmRlZCBW\nYWxpZGF0aW9uIFNlcnZlciBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC\nggEBANdTpARR+JmmFkhLZyeqk0nQOe0MsLAAh/FnKIaFjI5j2ryxQDji0/XspQUY\nuD0+xZkXMuwYjPrxDKZkIYXLBxA0sFKIKx9om9KxjxKws9LniB8f7zh3VFNfgHk/\nLhqqqB5LKw2rt2O5Nbd9FLxZS99RStKh4gzikIKHaq7q12TWmFXo/a8aUGxUvBHy\n/Urynbt/DvTVvo4WiRJV2MBxNO723C3sxIclho3YIeSwTQyJ3DkmF93215SF2AQh\ncJ1vb/9cuhnhRctWVyh+HA1BV6q3uCe7seT6Ku8hI3UarS2bhjWMnHe1c63YlC3k\n8wyd7sFOYn4XwHGeLN7x+RAoGTMCAwEAAaOCAUkwggFFMBIGA1UdEwEB/wQIMAYB\nAf8CAQAwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEF\nBQcDAjA0BggrBgEFBQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRp\nZ2ljZXJ0LmNvbTBLBgNVHR8ERDBCMECgPqA8hjpodHRwOi8vY3JsNC5kaWdpY2Vy\ndC5jb20vRGlnaUNlcnRIaWdoQXNzdXJhbmNlRVZSb290Q0EuY3JsMD0GA1UdIAQ2\nMDQwMgYEVR0gADAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5j\nb20vQ1BTMB0GA1UdDgQWBBQ901Cl1qCt7vNKYApl0yHU+PjWDzAfBgNVHSMEGDAW\ngBSxPsNpA/i/RwHUmCYaCALvY2QrwzANBgkqhkiG9w0BAQsFAAOCAQEAnbbQkIbh\nhgLtxaDwNBx0wY12zIYKqPBKikLWP8ipTa18CK3mtlC4ohpNiAexKSHc59rGPCHg\n4xFJcKx6HQGkyhE6V6t9VypAdP3THYUYUN9XR3WhfVUgLkc3UHKMf4Ib0mKPLQNa\n2sPIoc4sUqIAY+tzunHISScjl2SFnjgOrWNoPLpSgVh5oywM395t6zHyuqB8bPEs\n1OG9d4Q3A84ytciagRpKkk47RpqF/oOi+Z6Mo8wNXrM9zwR4jxQUezKcxwCmXMS1\noVWNWlZopCJwqjyBcdmdqEU79OX2olHdx3ti6G8MdOu42vi/hw15UJGQmxg7kVkn\n8TUoE6smftX3eg==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIDxTCCAq2gAwIBAgIQAqxcJmoLQJuPC3nyrkYldzANBgkqhkiG9w0BAQUFADBs\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j\nZSBFViBSb290IENBMB4XDTA2MTExMDAwMDAwMFoXDTMxMTExMDAwMDAwMFowbDEL\nMAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3\nLmRpZ2ljZXJ0LmNvbTErMCkGA1UEAxMiRGlnaUNlcnQgSGlnaCBBc3N1cmFuY2Ug\nRVYgUm9vdCBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMbM5XPm\n+9S75S0tMqbf5YE/yc0lSbZxKsPVlDRnogocsF9ppkCxxLeyj9CYpKlBWTrT3JTW\nPNt0OKRKzE0lgvdKpVMSOO7zSW1xkX5jtqumX8OkhPhPYlG++MXs2ziS4wblCJEM\nxChBVfvLWokVfnHoNb9Ncgk9vjo4UFt3MRuNs8ckRZqnrG0AFFoEt7oT61EKmEFB\nIk5lYYeBQVCmeVyJ3hlKV9Uu5l0cUyx+mM0aBhakaHPQNAQTXKFx01p8VdteZOE3\nhzBWBOURtCmAEvF5OYiiAhF8J2a3iLd48soKqDirCmTCv2ZdlYTBoSUeh10aUAsg\nEsxBu24LUTi4S8sCAwEAAaNjMGEwDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQF\nMAMBAf8wHQYDVR0OBBYEFLE+w2kD+L9HAdSYJhoIAu9jZCvDMB8GA1UdIwQYMBaA\nFLE+w2kD+L9HAdSYJhoIAu9jZCvDMA0GCSqGSIb3DQEBBQUAA4IBAQAcGgaX3Nec\nnzyIZgYIVyHbIUf4KmeqvxgydkAQV8GK83rZEWWONfqe/EW1ntlMMUu4kehDLI6z\neM7b41N5cdblIZQB2lWHmiRk9opmzN6cN82oNLFpmyPInngiK3BD41VHMWEZ71jF\nhS9OMPagMRYjyOfiZRYzy78aG6A9+MpeizGLYAiJLQwGXFK3xPkKmNEVX58Svnw2\nYzi9RKR/5CYrCsSXaQ3pjOLAEFe4yHYSkVXySGnYvCoCWw9E1CAx2/S6cCZdkGCe\nvEsXCS+0yx5DaMkHJ8HSXPfqIbloEpw8nL+e/IBcm2PN7EeqJSdnoDfzAIJ9VNep\n+OkuE6N36B9K\n-----END CERTIFICATE-----\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA6gl3/OlMWiHH42PZdAjaLvTSZXlfwxH9asDLRjINveQBOF+x\n24sqjwwqYKbtHhydV6SqdcbK2vpvnJTCPpmf2HTJkJAvDv3BiGzTqryT7Vjp65lG\nOJWJMVjbiTaMOS0pdJNMznVo07gTws8qkdaCHUxBmxF87CMCQxdqGJH4f4gkh3Fd\nH1csIEVpcD6rNLDSA2zkbn06TpaRfqMncXaFP+H0Whhe2Bx0sE1GhsBp2GkIOq+r\nUsFaksCXYo6eKyi+MZeqR4+ah4P+ABwqcHbopaFETFpibAVuRrYwpIcxm97hwyDL\nSsrRRDk8JxwfH4ncRtfET8tekthU5h+sl+kOZQIDAQABAoIBADhWTyvyfQ61UwjJ\n4G6uMtda18rVjNfIXNh10Hj1U5mCaUjIwGe4+GW25/ycMjgtazLN0LrJP8u2vWdT\n5+5pzLCubFcAXlOdghj1GX7gJjvcS3MLUnwMgxn96dr95oNc+720N6j7WmCczyT1\n+alhmbCzypcpfojZZJIB8Og5Ozh3d2ZAkOe7GRLcP/NC29t8yms1x/lfGvJWkpCm\nA5IX2C0jQ+RQ+KwkRfoGEDx8JAdLLnQHJdy4o+zmzJ9Uo41abwGWGXfUGNhLZOjr\nz7k4hhaX0+IgdcvQJ2XV+8X42phOPhQ5y/d5yPgKfUHizOa6kYoETFVHg/DW9Gyo\n2FPju4ECgYEA/h9rzp11+1suhDfBC2hz5xZVqYjzOcj/QMHXt0LByimEi93n+hf8\nt0xkwkGv+vA0J6D9M1XMgnV+LgFjMExfYoY8xzWfaIykxgy5X8cFyV0N1S874Y9i\nkTtDqPe9JiBXanNE1TmmQ5zcnpSTwelXJW+3ap017q/Ip1W5DtcC6VsCgYEA68QQ\nFebxRlpLCVFevfE5tMrQ0T0uR+XkFnZLXqfFLkjO2hUI+ljWv363BQHgpu610pfJ\n71t84eP3OPzuG8sWROLVg9FUJMwRohJFUAhVnLOUTXWVjBYtt0zq+XXuYnEAF7ns\nDjE+gnW3JGG4ao7fPLzO+0tyPJpyQPpgTdbFsz8CgYEAlUMjcYKvb+pI0kRlUSwT\nF+LYgfH82y4iL4ksCWpepT3pqrW2sgEw4QEwFaG7metI1xYKYwK8UsxsRt1tw0q4\npAgw3tmyPhiOF/4VTBp8XaAYpeVOiNhNjvx+a1rIcQKCFfaKsatg60nRlBu1Birm\nkwihdS/OI9qAQzlorzy/aw0CgYAqtmV3olQ5u6f2czBn1ujucQPttFjLG8H7s8ip\nyFk3rmcTKVZsDGYzYSCFHrb1Zy+3jFpAK+HvBp7GS0RT8rIBHtsxu120IOhc5VR7\nUFc6QWpvsgq6y1XS7HNxaEUcvn4Wzk8Orys09WCNjcqcO3AED+yrqBp1EkH6taF2\n2J8OfwKBgQCV04QaRFkZ3tMUloujkw7GHlttGL0TmzYZihHZZqRzUArwrSvDkHvA\nHJkv0Ui/Y+/Ka9rffS1DgeCU/3e2Sgl60MfzNfBfQeSLRmSClfQkOrOBiZmE+P+N\nWNx5qjhYfth00757jNTQmLDJELZBtyJ18IDLV8AFnhnaCOVO6Ut/JQ==\n-----END RSA PRIVATE KEY-----\n

#
# API Backend Server
#
api:
  image: 'weoedu/api:production'
  tags:
    - production
  autoredeploy: true
  autorestart: 'always'
  target_num_containers: 6
  links:
    - redis # We don't actually use the link or the env vars to connnect to
            # redis, but we need to put the link here to ensure redis boots up
            # before the API
  expose:
    - '3000'
  environment:
    PORT: 3000
    CLEVER_CLIENT_ID: 504ffa19024513570be4
    CLEVER_SECRET: 87b3e092190e5787a10c9e0e18886221b483a553
    DEBUG: weo:*
    EMAIL_FRONTEND: http://weo.io
    EMAIL_PASS: elliotrileytio
    EMAIL_USER: info@weo.io
    MANDRILL_API_KEY: GAs1A7BXpHBZM5Rl2FLcig
    MAILCHIMP_API_KEY: 8a86dfde003377d5b2e32668c99369ce
    MAILCHIMP_DATACENTER: us11
    MAILCHIMP_INVITE_LIST_ID: 4c10c5f1a7
    GOOGLE_CLIENT_ID: 696300823052-gluo2j11ec7jfocj7opqt8qpmosbducq.apps.googleusercontent.com
    GOOGLE_SECRET: POE6EaRNeXWLP8DPafQOBR-Y
    MONGO_URL: mongodb://db:X4ubrTLYLcDm8HS@lighthouse.1.mongolayer.com:10273,lighthouse.0.mongolayer.com:10273/eos?replicaSet=set-54e81ced9b093226ee0008ef&autoReconnect=true
    NODE_ENV: production
    PAPERTRAIL_HOST: logs2.papertrailapp.com
    PAPERTRAIL_PORT: 15920
    S3_API_KEY: AKIAIIA5OZD3IKVSUXDA
    S3_UPLOAD_BUCKET: weo-uploads
    S3_UPLOAD_REGION: us-west-2
    S3_UPLOAD_SECRET: 5bvPGCODzU/rzfyjq6F0VQN7hkO4AWzqONRkclig
    REDIS_URL: tcp://user:password@redis.production.8ef58fd1.svc.dockerapp.io:6379
    SCRAPER_URL: http://scraper.weo.io/1/oembed/
    UPLOAD_SIZE_LIMIT: 20mb
    AVATAR_SERVER: //avatars.global.ssl.fastly.net
    FASTLY_API_KEY: 5fcca7ec8ce5850f169a5589f0cf3a62
    FASTLY_AVATAR_SERVICE_ID: 66wIYwgwWKRCkZVOIXILTd
    WEO_API_FEATURED: 5595a59342d1080b00920bfe,55ca9a978cb0b1100052be67,55b02d80c8a4620e00ef7fe9,54aaff61bf530f0200f351c7
    FACEBOOK_APP_ID: 1662916197276541
    FACEBOOK_SECRET: 3d3d29e3ad0ce59945447b71b804e0f0
    TEMPLATE_BOARD_ID: 56149fd19c9d5d0c0024ad3c
    JWT_KEY: 2nkSzCwMboGIOI1Q
    SEGMENT_IO_KEY: 0mhgcgv6ao
    KHAN_CONSUMER_KEY: RmFAeWUah2X4HdNY
    KHAN_CONSUMER_SECRET: ezcnXCHTTXp7pnja
    OFFICE365_CLIENT_ID: 570e8309-8141-4588-b74d-ca708fd29ac3
    OFFICE365_SECRET: W4ksxmCEQby2ZPLyk6piuYp0MxNA/bAhqIJAQLJm+TE=

#
# Redis
#
redis:
  autorestart: 'always'
  tags:
    - production
  image: 'tutum/redis:latest'
  expose:
    - '6379'
  ports:
    - '6379:6379'
  environment:
    REDIS_PASS: password
